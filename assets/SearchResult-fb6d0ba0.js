import{u as J,a as j,l as M,b as O,m as V,c as W,n as _,y as z,h as K,d as N,e as T,v as X,L as Y,H as Z,f as ee,r as L}from"./app-dcdee9d1.js";import{c as te,B as se,G as ae,r as g,h as w,w as x,j as t,R as Q,J as le,i as ue}from"./framework-ac1910cc.js";const re="search-pro-result-history",o=J(re,[]),ne=()=>{const{resultHistoryCount:u}=L,c=u>0;return{enabled:c,resultHistory:o,addResultHistory:l=>{c&&(o.value.length<u?o.value=[l,...o.value]:o.value=[l,...o.value.slice(0,u-1)])},removeResultHistory:l=>{o.value=[...o.value.slice(0,l),...o.value.slice(l+1)]}}},oe=u=>{const c=j(),l=g(!1),h=g([]);let i;const v=ee(d=>{l.value=!0,i==null||i.terminate(),d?(i=new Worker(`/vuePress/${L.worker}`,{}),i.addEventListener("message",({data:f})=>{h.value=f,l.value=!1}),i.postMessage({query:d,routeLocale:c.value})):(h.value=[],l.value=!1)},L.delay);return x([u,c],()=>v(u.value),{immediate:!0}),{searching:l,results:h}};var ve=te({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(u,{emit:c}){const l=T(),h=se(),i=j(),v=M(X),{addQueryHistory:d}=Y(),{enabled:f,resultHistory:b,addResultHistory:q,removeResultHistory:A}=ne(),R=ae(u,"query"),{results:y,searching:E}=oe(R),r=g(0),a=g(0),C=w(()=>b.value.length>0),$=w(()=>y.value.length>0),H=w(()=>y.value[r.value]||null),U=()=>{r.value=r.value>0?r.value-1:y.value.length-1,a.value=H.value.contents.length-1},B=()=>{r.value=r.value<y.value.length-1?r.value+1:0,a.value=0},F=()=>{a.value<H.value.contents.length-1?a.value=a.value+1:B()},G=()=>{a.value>0?a.value=a.value-1:U()},D=e=>e.map(s=>ue(s)?s:t(s[0],s[1])),S=e=>{if(e.type==="custom"){const s=Z[e.index]||"$content",[p,m=""]=le(s)?s[i.value].split("$content"):s.split("$content");return D([p,...e.display,m])}return D(e.display)},k=()=>{r.value=0,a.value=0,c("updateQuery",""),c("close")};return O("keydown",e=>{if($.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")F();else if(e.key==="Enter"){const s=H.value.contents[a.value];l.value.path!==s.path&&(d(u.query),q(s),h.push(s.path),k())}}}),x([r,a],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result",{empty:R.value?!$.value:!C.value}],id:"search-pro-results"},R.value===""?C.value?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},v.value.history),b.value.map((e,s)=>t(Q,{to:e.path,class:["search-pro-result-item",{active:a.value===s}],onClick:()=>{k()}},()=>[t(V,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.type==="content"&&e.header?t("div",{class:"content-header"},e.header):null,t("div",S(e))]),t("button",{class:"search-pro-close-icon",onClick:p=>{p.preventDefault(),p.stopPropagation(),A(s)}},t(W))]))])):f?v.value.emptyHistory:v.value.emptyResult:E.value?t(_,{hint:v.value.searching}):$.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:s},p)=>{const m=r.value===p;return t("li",{class:["search-pro-result-list-item",{active:m}]},[t("div",{class:"search-pro-result-title"},e||"Documentation"),s.map((n,I)=>{const P=m&&a.value===I;return t(Q,{to:n.path,class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{d(u.query),q(n),k()}},()=>[n.type==="content"?null:t(n.type==="title"?z:n.type==="heading"?K:N,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="content"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",S(n))])])})])})):v.value.emptyResult)}});export{ve as default};
